<VirtualHost *:80>
    #ServerAdmin webmaster@localhost

    ServerName <%= params["server_name"].first %>
    <%# TODO handle the other server names %>

	<%# TODO make sure target_url ends with a slash %>
    ProxyPass / <%= params["target_url"] %>
    ProxyPassReverse / <%= params["target_url"] %>

    ProxyPreserveHost On
    <% if params.has_key?("timeout") %>
    ProxyTimeout <%= params["timeout"] %>
    <% end %>
    
	LogLevel warn
    ErrorLog <%= apache_log_dir %>/<%= params["server_name"] %>.error.log
    CustomLog <%= apache_log_dir %>/<%= params["server_name"] %>.vop.access.log vop
</VirtualHost>